# Log de Desenvolvimento — 2025-09-12

## 1. Estrutura do projeto
- Organizamos as pastas seguindo padrão **MVC** + boas práticas:
  ```
  /public      -> arquivos acessíveis pelo navegador (index.php, assets, uploads)
  /app
    /Controllers
    /Models
    /Views
    /Core      -> Database.php, Router.php
    /Config    -> config.php, routes.php
  /database    -> migrations, seeds, dumps
  /storage     -> relatórios, logs
  /vendor      -> dependências do Composer
  .env         -> variáveis de ambiente
  composer.json
  ```

## 2. Banco de dados (MySQL)
- Definimos no `.env` as credenciais (`DB_HOST`, `DB_PORT`, `DB_NAME`, `DB_USER`, `DB_PASS`).
- Criamos o banco `unifio_sga` com charset `utf8mb4`.
- Estruturamos migrations para tabelas principais:
  - `users`
  - `eventos`
- Implementamos restrições como `UNIQUE (data_evento, periodo)` para garantir que não haja dois agendamentos no mesmo horário.

## 3. Configuração do Composer
- Instalamos dependências:
  ```bash
  composer require vlucas/phpdotenv phpmailer/phpmailer dompdf/dompdf respect/validation
  ```
- Configuramos o **autoload PSR-4** no `composer.json`:
  ```json
  "autoload": {
    "psr-4": {
      "App\\": "app/",
      "Core\\": "app/Core/"
    }
  }
  ```
- Rodamos `composer dump-autoload` para atualizar o autoloader.

## 4. Bootstrap do projeto (`public/index.php`)
- Configuramos o **front controller** com:
  - `autoload.php` do Composer
  - carregamento do `.env`
  - definição de constantes (`ROOT_PATH`, `APP_PATH`, `VIEW_PATH`)
  - inclusão de `config.php`, `Router.php`
  - inicialização do objeto `$router`
  - carregamento de `routes.php`
  - dispatch da requisição

## 5. Configurações globais (`app/Config/config.php`)
- Definimos:
  ```php
  if (!defined('APP_PATH')) define('APP_PATH', ROOT_PATH . '/app');
  if (!defined('VIEW_PATH')) define('VIEW_PATH', APP_PATH . '/Views');
  ```
- Garantimos que não haja redefinição de constantes (evitando warnings).

## 6. Router (`app/Core/Router.php`)
- Criamos um roteador simples com suporte a métodos `GET` e `POST`.
- Normalização das rotas para evitar barras duplicadas.
- Possibilidade de usar controllers via `[Controller::class, 'metodo']`.

## 7. Rotas (`app/Config/routes.php`)
- Definimos rotas iniciais:
  - `/` → Home (`AuthController::home`)
  - `/login`, `/register`, `/logout`
  - `/eventos` (esportivo, não esportivo, cancelar)
  - `/perfil`

## 8. Controllers e Views iniciais
- Criamos `AuthController` com método `home()` carregando `home.php`.
- Criamos view `app/Views/home.php` com HTML básico para testar.
- Confirmamos que o fluxo de **rotas → controller → view** funciona.

## 9. Debugs e Correções
- Corrigimos:
  - Caminho quebrado no `require` (`__DIR__.'..'` → `dirname(__DIR__)`).
  - Erro de namespace (`app\\Controllers` → `App\\Controllers`).
  - Problema de `$router` nulo (ordem de criação no `index.php`).
  - Constantes duplicadas (`APP_PATH`, `VIEW_PATH`).
- Testamos com `var_dump(file_exists(...))` e confirmamos que os arquivos estavam sendo encontrados.
- Lidamos com o erro de timeout no `composer serve`, entendendo que o ideal é rodar direto:
  ```bash
  php -S localhost:8000 -t public
  ```

## ✅ Status final
- Servidor local rodando em `http://localhost:8000`.
- Roteamento básico funcionando.
- View inicial carregando.
- Estrutura sólida pronta para evoluir (login, cadastro, eventos, perfil, relatórios).